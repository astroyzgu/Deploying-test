HBT
===

Subhalo files
-------------

Subhalo files are generated with HBT+ code (`Han et
al. 2018 <https://ui.adsabs.harvard.edu/abs/2018MNRAS.474..604H/abstract>`__).
You can find a general description of output at `this
website <https://github.com/Kambrian/HBTplus/wiki/Outputs>`__. Dataset
is saved in such a **‘Subhalo_xxx.ppp.hdf5’** file.

::

   Subhalo_xxx.ppp.hdf5:
   xxx is the snapshot number from 0 to 127. Here 127 corresponds to redshift z=0. 
   ppp is the number of divided regions. 

We show the adopted parameters during HBT+ running in the following. ##
Code parameters

+-----------------------+-----------------------+-----------------------+
| name                  | value                 | description           |
+=======================+=======================+=======================+
| ``SnapshotPath``      | /home/cossim/Jiutian/ | snapshot path         |
|                       | M1000/simu            |                       |
+-----------------------+-----------------------+-----------------------+
| ``HaloPath``          | /home/cossim/Jiutian/ | host halo path        |
|                       | M1000/groups          |                       |
+-----------------------+-----------------------+-----------------------+
| ``SubhaloPath``       | /home/cossim/Jiutian/ | subhalo path          |
|                       | M1000/hbt             |                       |
+-----------------------+-----------------------+-----------------------+
| ``SnapshotFileBase``  | snapshot              |                       |
+-----------------------+-----------------------+-----------------------+
| ``MaxSnapshotIndex``  | 127                   |                       |
+-----------------------+-----------------------+-----------------------+
| ``BoxSize``           | 1000\                 |                       |
|                       |                       |                       |
|                       | .. math:: Mpc/h       |                       |
+-----------------------+-----------------------+-----------------------+
| ``SofteningHalo``     | 0.004                 |                       |
+-----------------------+-----------------------+-----------------------+
| ``SnapshotFormat``    | gadget                |                       |
+-----------------------+-----------------------+-----------------------+
| ``GroupFileFormat``   | gadget3_MXXL          |                       |
+-----------------------+-----------------------+-----------------------+
| ``MaxConcurrentIO``   | 512                   |                       |
+-----------------------+-----------------------+-----------------------+
| ``MinSnapshotIndex``  | 0                     |                       |
+-----------------------+-----------------------+-----------------------+
| ``MinNumPartOfSub``   | 20                    | minimum number of     |
|                       |                       | particles in subhalos |
+-----------------------+-----------------------+-----------------------+
| ``MassInMsunh``       | 1e+10                 | mass unit             |
|                       |                       |                       |
|                       | .. math:: M_{\odot}/h |                       |
+-----------------------+-----------------------+-----------------------+
| ``LengthInMpch``      | 1 Mpc/h               | length unit           |
+-----------------------+-----------------------+-----------------------+
| ``VelInKmS``          | 1 km/s                | velocity unit         |
+-----------------------+-----------------------+-----------------------+
| ``PeriodicBoundaryOn` | 1                     |                       |
| `                     |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``SnapshotHasIdBlock` | 1                     |                       |
| `                     |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``ParticleIdRankStyle | 0                     |                       |
| ``                    |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``ParticleIdNeedHash` | 1                     |                       |
| `                     |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``SnapshotIdUnsigned` | 0                     |                       |
| `                     |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``SaveSubParticleProp | 0                     |                       |
| erties``              |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``MergeTrappedSubhalo | 1                     |                       |
| s``                   |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``MajorProgenitorMass | 0.8                   |                       |
| Ratio``               |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``BoundMassPrecision` | 0.995                 |                       |
| `                     |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``SourceSubRelaxFacto | 3                     |                       |
| r``                   |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``SubCoreSizeFactor`` | 0.25                  |                       |
+-----------------------+-----------------------+-----------------------+
| ``SubCoreSizeMin``    | 20                    |                       |
+-----------------------+-----------------------+-----------------------+
| ``TreeAllocFactor``   | 0.8                   |                       |
+-----------------------+-----------------------+-----------------------+
| ``TreeNodeOpenAngle`` | 0.45                  |                       |
+-----------------------+-----------------------+-----------------------+
| ``TreeMinNumOfCells`` | 10                    |                       |
+-----------------------+-----------------------+-----------------------+
| ``MaxSampleSizeOfPote | 1000                  |                       |
| ntialEstimate``       |                       |                       |
+-----------------------+-----------------------+-----------------------+
| ``RefineMostboundPart | 1                     |                       |
| icle``                |                       |                       |
+-----------------------+-----------------------+-----------------------+

We show the information of **‘Subhalo_xxx.ppp.hdf5’** file in the
following.

keys value
----------

+--------------------------------+-------------------------------------+
| name                           | description                         |
+================================+=====================================+
| ``Cosmology``                  | cosmology parameters                |
+--------------------------------+-------------------------------------+
| ``NestedSubhalos``             |                                     |
+--------------------------------+-------------------------------------+
| ``NumberOfFakeHalos``          |                                     |
+--------------------------------+-------------------------------------+
| ``NumberOfFiles``              | number of files in present snapshot |
+--------------------------------+-------------------------------------+
| ``NumberOfNewSubhalos``        |                                     |
+--------------------------------+-------------------------------------+
| ``NumberOfSubhalosInAllFiles`` | number of subhalos in all files     |
+--------------------------------+-------------------------------------+
| ``SnapshotId``                 | snapshot ID                         |
+--------------------------------+-------------------------------------+
| ``SubhaloParticles``           | particles in subhalos               |
+--------------------------------+-------------------------------------+
| ``Subhalos``                   | details of found subhalos           |
+--------------------------------+-------------------------------------+

.. code:: note

   The total number of subhalos in each file is not included!

fields in ``Cosmology``
-----------------------

+------------------+--------+------------------------+
| name             | value  | description            |
+==================+========+========================+
| ``HubbleParam``  | 100    | H                      |
+------------------+--------+------------------------+
| ``OmegaLambda0`` | 0.6889 | .. math:: O_{\Lambda0} |
+------------------+--------+------------------------+
| ``OmegaM0``      | 0.3111 | .. math:: O_{m0}       |
+------------------+--------+------------------------+
| ``ScaleFactor``  | 1      |                        |
+------------------+--------+------------------------+

fields in ``Subhalos``
----------------------

+--------------+-----------------------+-------------------+-----------+
| name         | description           | unit              | data type |
+==============+=======================+===================+===========+
| ``TrackId``  | unique subhalo ID     |                   | int64     |
+--------------+-----------------------+-------------------+-----------+
| ``Nbound``   | number of bound       |                   | int64     |
|              | particles             |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``Mbound``   | total mass of bound   |                   | float32   |
|              | particles             |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``HostHaloId | host halo ID          |                   | int64     |
| ``           |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``Rank``     | the order of          |                   | int64     |
|              | subhaloes inside the  |                   |           |
|              | group                 |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``Depth``    | the level of the      |                   | int32     |
|              | subhalo in the        |                   |           |
|              | merging hierarchy     |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``LastMaxMas |                       |                   | float32   |
| s``          |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SnapshotIn |                       |                   | int32     |
| dexOfLastMax |                       |                   |           |
| Mass``       |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SnapshotIn |                       |                   | int32     |
| dexOfLastIso |                       |                   |           |
| lation``     |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SnapshotIn |                       |                   | int32     |
| dexOfBirth`` |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SnapshotIn |                       |                   | int32     |
| dexOfDeath`` |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SnapshotIn |                       |                   | int32     |
| dexOfSink``  |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``RmaxComovi |                       |                   | float32   |
| ng``         |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``VmaxPhysic |                       |                   | float32   |
| al``         |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``LastMaxVma |                       |                   | float32   |
| xPhysical``  |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SnapshotIn |                       |                   | int32     |
| dexOfLastMax |                       |                   |           |
| Vmax``       |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``R2SigmaCom |                       |                   | float32   |
| oving``      |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``RHalfComov |                       |                   | float32   |
| ing``        |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``BoundR200C | R200 under critical   | Mpc/h             | float32   |
| ritComoving` | density               |                   |           |
| `            |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``BoundM200C | M200 under critica    | .. math:: 10^{10} | float32   |
| rit``        | density               |                   |           |
|              |                       | \                 |           |
|              |                       |                   |           |
|              |                       | .. math:: M_{\odo |           |
|              |                       | t}/h              |           |
+--------------+-----------------------+-------------------+-----------+
| ``SpecificSe |                       |                   | float32   |
| lfPotentialE |                       |                   |           |
| nergy``      |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SpecificSe |                       |                   | float32   |
| lfKineticEne |                       |                   |           |
| rgy``        |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SpecificAn |                       |                   | float32   |
| gularMomentu |                       |                   |           |
| m``          |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``InertialEi |                       |                   | float32   |
| genVector``  |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``InertialEi |                       |                   | float32   |
| genVectorWei |                       |                   |           |
| ghted``      |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``InertialTe |                       |                   | float32   |
| nsor``       |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``InertialTe |                       |                   | float32   |
| nsorWeighted |                       |                   |           |
| ``           |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``ComovingAv | average position from | Mpc/h             | float32   |
| eragePositio | bound particles       |                   |           |
| n``          |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``PhysicalAv | average velocity from | km/s              | float32   |
| erageVelocit | bound particles       |                   |           |
| y``          |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``ComovingMo | average position from | Mpc/h             | float32   |
| stBoundPosit | the most bound        |                   |           |
| ion``        | particles             |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``PhysicalMo | average velocity from | km/s              | float32   |
| stBoundVeloc | the most bound        |                   |           |
| ity``        | particles             |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``MostBoundP |                       |                   | int64     |
| articleId``  |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+
| ``SinkTrackI |                       |                   | int64     |
| d``          |                       |                   |           |
+--------------+-----------------------+-------------------+-----------+

.. code:: tip

   `Nbound`: Subhalos with `Nbound=1` are also listed. 

   `Rank`: `Rank=0` indicating the most-massive subhalo inside each group (i.e., the main/central subhalo).

   `Depth`: A central subhalo has `Depth=0`; those directly merged to the host halo of the central have `Depth=1` (i.e., sub-subhalos); those directly merged to depth=1 subhalos have `Depth=2` (i.e., sub-sub-subhalos). 
